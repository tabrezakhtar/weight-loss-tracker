---
---
<button id="exportCsvBtn" class="bg-blue-600 hover:bg-blue-700 text-white px-2 py-1 sm:px-4 sm:py-2 rounded-lg font-semibold transition-all duration-150 flex items-center gap-1 sm:gap-2 cursor-pointer text-xs sm:text-sm">
  ðŸ“ˆ Export to CSV
</button>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const exportCsvBtn = document.getElementById("exportCsvBtn");

    exportCsvBtn.addEventListener("click", () => {
      const entries = JSON.parse(localStorage.getItem("weightEntries") || "[]");

      if (entries.length === 0) {
        alert("No weight entries to export.");
        return;
      }

      const currentUnit = localStorage.getItem("weightUnit") || "kg";

      const headers = ["Date", `Weight (${currentUnit})`, "Timestamp"];
      const csvRows = [headers.join(",")];

      entries.forEach(entry => {
        const date = entry.date;
        const weight = entry.weight;
        const timestamp = entry.timestamp || "";
        csvRows.push(`${date},${weight},${timestamp}`);
      });

      const csvString = csvRows.join("\n");

      const blob = new Blob([csvString], { type: "text/csv;charset=utf-8;" });
      const url = URL.createObjectURL(blob);

      const downloadLink = document.createElement("a");
      const currentDate = new Date().toISOString().split("T")[0];
      downloadLink.setAttribute("href", url);
      downloadLink.setAttribute("download", `weight-tracker-data-${currentDate}.csv`);
      downloadLink.style.display = "none";

      document.body.appendChild(downloadLink);
      downloadLink.click();
      document.body.removeChild(downloadLink);

      setTimeout(() => {
        URL.revokeObjectURL(url);
      }, 100);
    });
  });
</script>