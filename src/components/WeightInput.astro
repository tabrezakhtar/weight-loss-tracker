---

---

<section>
  <form id="weight-form">
    <fieldset>
      <legend>Add Weight Entry</legend>
      <div>
        <label for="weight">Weight:</label>
        <input 
          type="number" 
          id="weight" 
          name="weight" 
          placeholder="Enter weight" 
          step="0.1" 
          min="0" 
          required
        />

        <label for="weight-date">Date:</label>
        <input 
          type="date" 
          id="weight-date" 
          name="date" 
          value={new Date().toISOString().split('T')[0]} 
          required
        />
        
        <button type="submit">Add</button>
      </div>
    </fieldset>
  </form>
  
  <div id="submission-message" role="status"></div>
</section>

<script>
  // Wait for the DOM to be fully loaded
  document.addEventListener("DOMContentLoaded", () => {
    const form = document.getElementById("weight-form");
    const messageElement = document.getElementById("submission-message");
    
    if (!form || !messageElement) {
      console.error("Required DOM elements not found");
      return;
    }
    
    // Function to generate a unique ID
    const generateId = () => {
      return Date.now().toString(36) + Math.random().toString(36).substr(2);
    };
    
    // Function to save weight entry to localStorage
    const saveWeightEntry = (entry) => {
      // Get existing entries from localStorage or initialize empty array
      const existingEntries = JSON.parse(localStorage.getItem("weightEntries") || "[]");
      
      // Add new entry with unique ID
      const newEntry = {
        id: generateId(),
        weight: entry.weight,
        date: entry.date,
        timestamp: new Date().toISOString()
      };
      
      // Add to array and save back to localStorage
      existingEntries.push(newEntry);
      localStorage.setItem("weightEntries", JSON.stringify(existingEntries));
      
      return newEntry;
    };
    
    // Handle form submission
    form.addEventListener("submit", (e) => {
      e.preventDefault();
      
      // Get form data
      const weightInput = document.getElementById("weight");
      const dateInput = document.getElementById("weight-date");
      
      if (!weightInput || !dateInput) {
        console.error("Form input elements not found");
        return;
      }
      
      const weight = weightInput.value;
      const date = dateInput.value;
      
      if (!weight || !date) {
        messageElement.textContent = "Please fill in all required fields";
        messageElement.style.color = "red";
        return;
      }
      
      // Save the entry
      const savedEntry = saveWeightEntry({ weight, date });
      
      // Show success message
      // messageElement.textContent = `Weight entry saved successfully (ID: ${savedEntry.id})`;
      // messageElement.style.color = "green";
      
      // Reset form
      form.reset();
      
      // Set the date field back to today
      dateInput.value = new Date().toISOString().split("T")[0];
      
      // Dispatch custom event for other components (like WeightList) to listen for
      const weightEvent = new CustomEvent("weightEntrySaved", {
        detail: savedEntry
      });
      window.dispatchEvent(weightEvent);
    });
  });
</script>

<style>
  form {
    margin: 1rem 0;
  }
  
  fieldset {
    border: 1px solid #ddd;
    border-radius: 4px;
    padding: 1rem;
  }
  
  legend {
    padding: 0 0.5rem;
    font-weight: bold;
  }
  
  fieldset > div {
    display: flex;
    gap: 0.5rem;
    align-items: center;
    flex-wrap: wrap;
  }
  
  label {
    margin-right: 0.2rem;
  }
  
  input {
    padding: 0.5rem;
    border: 1px solid #ccc;
    border-radius: 4px;
    margin-right: 0.8rem;
  }
  
  input[type="number"] {
    width: 80px;
  }
  
  button {
    padding: 0.5rem 1rem;
    background-color: #4caf50;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-weight: bold;
    margin-left: auto;
  }
  
  button:hover {
    background-color: #45a049;
  }
</style>